---
title: "史上最详细GTASA修改教程"
date: 2022-07-04T18:22:32+08:00
draft: false
author: "蝈总"
TocOpen: false\
hidemeta: false
comments: false
description: "Desc Text."
canonicalURL: "https://canonical.url/to/page"
disableHLJS: true # to disable highlightjs
disableShare: false
disableHLJS: false
hideSummary: false
searchHidden: true
ShowReadingTime: true
ShowBreadCrumbs: true
ShowPostNavLinks: true
editPost:
    URL: "https://github.com/Katock-Cricket/MyBlog/content"
    Text: "Suggest Changes" # edit text
    appendFilePath: true # to append file path to Edit link
---



![r2](1.png)*蕾米镇楼*



​		话说在前面，本教程**只针对PC**（我没关注过安卓，可能有差别），涵盖内容非常之大，意在尝试一劳永逸地解决所有关于GTASA的MOD安装相关问题，这么多年的老游戏了还是不断地有小白尝试搞懂怎么装各种MOD。为了容易看懂，我尽量通俗地描述。仔细看完这篇文章，我相信你的疑惑八成就解决的差不多了，即使以后还遇到其他问题也能自己尝试一些解决办法。我会分以下几个方面介绍：

​                                        **观前提醒：任何替换操作都有可能失败，注意备份原文件！**

[TOC]



# 游戏文件组成

## 文件类型

1. `cfg`：配置文件，存放用户设置、配置数据，游戏里用于存放各种参数，例如载具速度等；
2. `ide`：功能同cfg，存储数据参数，例如武器伤害值等；
3. `dat`：一般系统会把它识别成媒体文件，这是因为它大多是MPG格式转换成的。但SA的dat文件也只是一种广义的配置文件，同cfg和ide，存储数据或记录；
4. `ifp`：专属于R星公司开发游戏的文件，存储动作（动画）信息，例如人物走路姿势；
5. **`img`**：对OS熟悉的应该知道，这是一种镜像文件，可以理解成把光盘软盘上的内容压缩归档，变成了这种数字格式。SA的img文件有压缩模型文件的，也有压缩动画文件的，可以理解成一些同类文件的压缩文件；（不要忘记SA最早是PS2平台的，有这种奇怪格式的东西并不奇怪）
6. `ico/icn`：顾名思义图标文件；
7. `ipl`文件：全称`Item Placement File`，专属于R星开发游戏的格式，存储各种位置信息，例如加特林的刷新地点，一般轮不着我们直接修改，一些地图MOD才会用到；
8. `fxp`：这个我没怎么看懂，不过它是用来存储一些特效的，例如开枪的火光和爆炸等；
9. `gxt`：字体文件；
10. **`dff`**：一般系统会把它识别成音乐，但SA的dff是3D模型文件，像obj, ply等文件一样存储3D模型信息；
11. **`txd`**：与dff文件配套的贴图文件

## 游戏文件

**打开游戏根目录，有这样几个文件需要了解：**

**anim文件夹**

1. `anim.img`：存储一些动作文件，例如驾驶载具时CJ的姿势；
2. `cuts.img`：过场动画里任务的动作文件；
3. `ped.ifp`：一般游戏过程中CJ和NPC的姿势，例如走路；

**audio文件夹**：

这是区分完整版和阉割版的重要证据，完整版游戏有全套声音，包括过场动画和电台音乐都在audio里，而且audio占了90%的存储空间，完整版游戏至少3.8G左右；

1. `SFX`：里面的文件都是特殊编码（其实不复杂）的音效文件，一般的软件无法将其解码；
2. `stream`：同上，它里面大部分是音乐文件和过场动画的音效；

**data文件夹**：

大部分不必深究，大型MOD都是直接覆盖，犯不着你自己去一个个修改。经常手动修改的无非如下几个

1. `carcols.dat/ carmods.dat/ handling.cfg/ vehicles.ide`：车辆数据，总体上都是牵一发而动全身的危险数据，网上有修改handling.cfg文件的教程但是不权威，**我建议尽量不要自己单独改某一个文件**，会引发很多乱七八糟的问题；
2. `weapon.dat`：武器数据，建议同上，除了伤害值这些耦合性较低的参数可以自己改着玩一玩，其他不建议自己乱改；
3. `*grp.dat`：星号代表可以有多种前缀，这种文件存储了游戏物体的刷出特性，例如什么地方什么时间会刷出什么东西来，我做《侠盗终章》大电影的时候就是修改了这类文件，达到了午夜也能刷出很多人和车发生暴动的效果；

**models文件夹**：

顾名思义它就是存储了游戏模型和贴图等文件的地方，只需要记住三个文件在这里：

1. `gta3.img`：车辆npc等常用模型
2. `cutscene.img`：过场动画的模型
3. `player.img`：主角的模型，包括各种服饰

---



# NPC模型替换

通过上面的解析应该已经知道，游戏过程和过场动画用的是两套模型，非过场动画过程中的npc是一般npc

## 一般NPC的替换

一般NPC的模型都在gta3.img里，每个模型都包括同名的dff和txd。比如最常见的卡车司机NPC，名字是male01，那么它的模型文件就是male01.dff和male01.txd：

![image-20220704233022485](2.png)

SA如何确定“这个模型是这个npc的模型”的呢？其实就是通过它的名字。

所以如果要将这个NPC替换成你喜欢的人物（例如胡桃），做法是这样的：想必你已经下载了胡桃的MOD，里面可以找到HuTao.dff和Hutao.txd，那就把这俩文件重命名为male01.dff和male01.txd，替换掉gta3.img中的原有文件。然后启动游戏，就能发现所有卡车司机都变成了胡桃。如何打开和修改img文件，后面的工具介绍有。

## 过场动画的替换

过场动画的模型都在cutscene,img里，如果你打开这个img就会发现大部分模型都有cs前缀，是cutscene的缩写。这里有一个不太广泛但是可以记一下的规律，就是对于过场动画和一般场景下都出现过的npc，他们的名字往往都只有一个“cs”前缀的差别，例如斯威特在gta3.img里叫sweet.dff/txd，在cutscene.img里就叫cssweet.dff/txd。当然也有不少例外，比如大结局里穿防弹衣的斯莫克，在gta3.img里叫smokev.dff/txd，在cutscene.img里就成了cssmokevest.dff/txd。

过场动画和一般过程用的模型有一点差别，有时候是无法通用同一个mod的。一般过程的模型兼容性较好，换成别的mod不容易出问题，但是过场动画不能保证。



# 主角模型替换

主角是模型替换里最复杂的一个，目前有两种办法：

1. 一种是某些mod就是专门针对替换主角的，他们提供的文件可能只有一个player.img，那这就比较简单了，直接替换原来的player.img就完事儿，但是网上支持这样做的MOD非常少，所以我们接下来的讨论都是针对另一种方法的；

2. 另一种是借助更换人物cleo和一对dff/txd文件，实现用一个简单模型替换掉复杂的主角模型。

但是能否替换掉过场动画里主角的模型，还是取决于更换人物cleo的功能，因为单纯的替换游戏dff/txd模型是难以修改过场动画的主角的。这方面的cleo可以来我群里拿。（文末）

---



# 车辆模型替换

车辆模型也是由dff和txd组成的，而且基本都在gta3.img里，替换起来并不复杂。而且在游戏过程中，主角登上一辆载具的同时，右下角会显示载具的名字，90%的载具文件名和本身的名字是一样的。

对车辆MOD感兴趣的可以专门背一背车辆表，每一个车辆都有自己的编号和名字，例如牛肉干NRG500就是522号，九头蛇（秘籍JUMPJET）就是521号，著名的炼狱魔TURISMO就是451号。在SAMP和一些刷车器中，就是通过提供车辆编号来刷出对应车辆的。这些编号在vehicles.ide中能查到（如图）。当然贴吧也有盘点。

![image-20220705150555399](3.png)

有一些车辆MOD会附带一个名为`ImVehFt`的文件夹，这个是车灯系统，需要安装`ImVehFt`“主程序”才能起作用。推荐工具里有教程，它是依附于cleo主程序的。

还有一些车辆MOD会附带车辆数据（往往在readme.txt里），参见下面的该数据注意事项。

（如图是同时具有ImVehFt和数据的MOD车包）

![image-20220705150730190](4.png)

---



# 数据文件修改

一般这种事情交给专门搞MOD的大神做就完事，我也尝试过但是并没有彻底搞明白，因为稍有不慎就容易给改废了。但是如果是自己随便改着玩玩，可以试试改如下几个属性：

在handling.cfg中，随便找到一行：

```
TURISMO 1400.0 3000.0 2.0 0.0 -0.3 -0.2 70 0.75 0.85 0.45 5 240.0 30.0 10.0 4 P 	11.0  0.51 0 30.0  	1.2  0.13  0.0   0.15 -0.20 0.5  0.4 0.17 0.72 95000 40002004 C08401 1  1 1
```

其中容易理解的属性对应如下：

| 属性   | 数值       | 说明                                                         |
| ------ | ---------- | ------------------------------------------------------------ |
| 名字   | TURISMO    | 车辆名字，这个不能改，用来检索的                             |
| 重量   | 1400和3000 | **大多网络资料有误**，应该是由两个数据控制，越大越重，太大可能溢出 |
| 4-12列 | 2.0~0.45   | 车辆尺寸重心等其他数据，比较玄学，尽量不要大幅度改           |
| 档数   | 5          | 这车最高能挂几档，玩家的直观感受就是开车加速时车辆“嗡”的次数 |
| 最高速 | 240        | 最高时速，可以改到365试试，这个速度你已经把握不住了，别太贪心 |
| 加速度 | 30和10     | **大多网络资料有误**，应该是由两个数据控制，可以改到四五十试试 |
| 驱动   | 4          | F前驱，R后驱，4四驱，没有别的选项，四驱是手感最舒服的        |
| 发动机 | P          | P汽油机，D柴油机，E电动机，汽油就行，柴油可能有抖动          |
| …      | 其他数据   | 刹车性能、刹车偏向、悬挂等参数，我没研究了，自行研究吧       |

---



# 画质补丁安装

所有MOD里，画质补丁是最容易安装失败的，画质补丁增加和替换了很多文件。

一方面是因为SA也有版本的区别，不同版本的SA对同一画质补丁兼容性不一样，可能别人能用的画质补丁到你这干脆打不开游戏；

一方面是因为电脑性能不同，高级一些的画质补丁会对电脑硬件配置提出很高的要求，其中材质包吃显存、光影特效吃运算，可能你下好了画质补丁但是又会因为太卡就后悔了；

另一方面是因为宣传和实际效果往往不一样，每一个画质补丁都有自己的缺点，就看你能不能接受了。

我个人的理解是，SA画质补丁就是往老引擎添加新东西，是一种极度牺牲优化的做法，所以不要指望有又流畅又华丽的画质补丁。

以我的个人经验，如果要畅玩全网90%的画质补丁，你需要具备7代i7及以上的CPU，GTX1060/1650及以上的显卡，游戏最好装在固态硬盘上。我个人不太喜欢玩画质补丁，只是偶尔作一下死。

安装方面，一般画质补丁都给你整理好了，直接把里面的东西覆盖到原目录就行，但是记得备份！

---



# 其他内容替换

## 音乐音效

这方面的替换并不多见，而且现成的MOD也不多，不过我也说一下怎么换吧。

这种MOD分两种，一种是直接发给你编码完成的音轨，直接替换掉原有文件就行，记得备份；（如图这种）

![image-20220705161637155](5.png)

另一种是提供给你wav或ogg文件，你要么得用挂载器，要么得用音频转换工具把它重新编码然后替换原文件。（如图这种注意看目录结构）

![image-20220705161758200](6.png)

## 一般的CLEO或补丁

CLEO就是扩展脚本，每个cleo都包含了一个.cs文件，用于修改一些游戏运行机制，例如一键回血。装好CLEO主程序后把cs文件放入游戏目录的cleo文件夹就完事，可能还有一些fxt文件，放到cleo/cleo_text里就完事。

一般的补丁可能是asi、dat、dll文件，在游戏开始启动时提供额外的加载项，把他们放到游戏目录就完事，前提是要有CLEO主程序。

---



# 运行疑难解答

如果你的SA是什么都没改过的纯净版，然后在电脑上运行不了，这种问题是系统兼容性问题，尝试一下这样设置：如果还不行的话建议换一个版本的SA，兼容性好的版本几乎不需要你做任何设置就能完美运行。

![image-20220705162624250](7.png)

如果提示你缺少Directx8，那就去下载一下，可能会顶用，但是我没有自己遇到过。



如果你是装了什么MOD后游戏崩溃了，那就是MOD冲突、错误安装、不兼容等问题导致的，一般情况下把最近安装的MOD挨个删掉就能筛查出问题来。我的个人经验如下：

1. 双击gta_sa.exe运行，游戏干脆进不去：安装的MOD与游戏版本不合或MOD冲突，解决办法是更换游戏版本或放弃使用MOD；
2. 读取存档时卡死闪退：存档与游戏版本不合，或MOD之间有冲突；
3. 进入存档的瞬间卡死闪退：99%是数据改错了或者模型出错了；
4. 游戏过程中卡死闪退：如果是游戏刷出的东西太多了就是mem爆了，解决办法安装limit adjuster补丁，如果是到了特定时间地点才死，解决方法检查模型音效等安装是否正确；

其实还有各种离奇问题，最好的办法就是把刚刚装上的MOD挨个去掉。但是还有例外，就是电脑系统更新导致的，这种问题非常少但是我也遇到过，至今不知道怎么办最好。

---



# 推荐工具教程

这里推荐几个GTA资源网站，部分需要翻墙，推荐度递减排序：

> www.gtainside.com
>
> gamemodding.com
>
> mod.3dmgame.com
>
> vcdiguo.ysepan.com
>
> www.moddb.com
>
> www.igta.vip
>
> www.mixmods.com.br
>
> gtaforums.com

所有提到的工具都在我的群里有（文章末尾）。



## CLEO4主程序

它存在的意义就是指着cleo文件夹和根目录，在游戏启动时告诉游戏“你还得额外加载这些乱七八糟的玩意”。最新的主程序应该包含：（全部放到游戏目录就算安装完成）

![image-20220705165453039](8.png)

那个cleo文件夹就是将来放入.cs文件的地方。



## MODLoader

就是MOD挂载器，它存在的意义就是让你不必为SA特殊的游戏编码发愁。

例如我要把HuTao.dff放入gta3.img，你可能需要一个IMG TOOL来编辑游戏原有的那个gta3.img。但是有挂载器的话，你只需要在modloader文件夹里新建一个文件夹（可以命名为gta3.img，一般情况下没有别的讲究），把HuTao.dff直接扔进这个文件夹就可以了。

挂载器会根据你放入modloader文件夹里的东西，在游戏运行过程中实时地替换掉原有文件。其他文件也是同理，一般MOD的附带说明会告诉你把哪些东西扔进modloader，你乖乖照做就行。

MODLoader一般用于替换游戏模型、游戏音乐音效、数据文件，当然它的能力不止这些就是了。

这是我的modloader里放的东西：

![image-20220705170332645](9.png)

经过前面那么多铺垫，你肯定已经知道每个文件夹里面放了什么东西了罢！

比如这是gta3.img里我放的东西：

![image-20220705170445529](10.png)

比如这是data里我放的东西：

![image-20220705170506927](11.png)

看到这里你应该已经明白，modloader让我们安装mod时避免直接修改游戏原文件，既简便又安全。



## PED查看器

这个东西可以查看游戏里大多数npc的信息，界面是这样：

![image-20220705170932224](12.png)

在里面你可以预览每个人物模型的名字长相和各种属性，用于提前确定要替换的人物。



## 声音替换工具

这个东西用于把游戏音频提取出来，也能把你自己的音频做到游戏里去，软件特别简单但是兼容性一般，用到的情况比较少。

![image-20220705171201265](13.png)



## TXD Workshop

用于查看img文件里的txd贴图，如果你没有ps之类的专业绘图软件，可以试试这个。

![image-20220705171400621](14.png)



## IMG Editor

可以打开img文件查看和编辑里面的东西，支持批量导出导入。

![image-20220705171539376](15.png)



IMG工具还有以前的IMG TOOL，不过显然已经成为时代的眼泪了（哭），我不推荐。



## 其他工具

DYOM是玩家DIY任务的一个程序，我试过但是不太感兴趣，诸位可以浅浅地了解一下。

还有一些特殊的主程序例如MoonLoader，灵活使用即可，应用范围比较小，一般情况用不到。



以上就是全部内容，更多资源和问题可以咨询Q群：如果是这篇文章也解决不了的问题，那就八成在我的能力范围外了。

![0e60be482a8f66c8db1a9a52ce4ddf9](16.jpg)

![b6c35f21848668c5382f81fd4fd5cb1](17.jpg)
