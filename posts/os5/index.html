<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>OS笔记5：IO系统 | 蝈蝈影视公司</title><meta name=keywords content><meta name=description content="Desc Text."><meta name=author content="Me"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=/MyBlog/assets/css/stylesheet.min.bd03b36c39adbc00eafcc5f0ba22ec2b9b908daa76cb014eb396e4da8a18f41b.css integrity="sha256-vQOzbDmtvADq/MXwuiLsK5uQjap2ywFOs5bk2ooY9Bs=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/MyBlog/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://Katock-Cricket.github.io/MyBlog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://Katock-Cricket.github.io/MyBlog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://Katock-Cricket.github.io/MyBlog/favicon-32x32.png><link rel=apple-touch-icon href=https://Katock-Cricket.github.io/MyBlog/apple-touch-icon.png><link rel=mask-icon href=https://Katock-Cricket.github.io/MyBlog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="OS笔记5：IO系统"><meta property="og:description" content="Desc Text."><meta property="og:type" content="article"><meta property="og:url" content="https://Katock-Cricket.github.io/MyBlog/posts/os5/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-06-12T00:00:00+00:00"><meta property="article:modified_time" content="2022-06-12T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="OS笔记5：IO系统"><meta name=twitter:description content="Desc Text."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://Katock-Cricket.github.io/MyBlog/posts/"},{"@type":"ListItem","position":3,"name":"OS笔记5：IO系统","item":"https://Katock-Cricket.github.io/MyBlog/posts/os5/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"OS笔记5：IO系统","name":"OS笔记5：IO系统","description":"Desc Text.","keywords":[],"articleBody":"五、I/O系统 IO控制方式 程序控制IO ​\t轮询IO，CPU代表进程向IO模块发出指令，然后忙等，直到IO完成；\n优点：简单\n缺点：CPU效率低\n中断驱动 ​\t不用不断询问，完成后由设备控制器主动地来通知设备驱动程序说这次结束；\n优点：提高CPU利用率\n缺点：每次IO都要中断CPU，浪费了时间\nDMA ​\t直接存储器访问方式，有专门的控制器完成IO\n优点：CPU只需干预开始和结束的工作，而其中的一批数据读写无需CPU控制，适用于数据块传输\n缺点：每个设备一个DMA\n通道 ​\t一个特殊的有自己的指令的处理器，专门负责IO，与CPU分时使用内存；\n优点：一个通道程序可以完成多个IO操作，减少CPU干预\n缺点：贵\n缓冲区 缓冲技术的优点：\n匹配CPU与外设的不同处理速度 减少CPU中断次数 提高CPU与IO设备的并行性 RAID 一种把多块独立的硬盘（物理硬盘）按照不同方式组合起来形成一个硬盘组（逻辑硬盘），从而提供比单个硬盘更高的存储性能和提供数据冗余的技术。\n优点：成本低，功耗小，传输速率高，可提供容错功能\nRAID0：仅提供了并行交叉存取。它虽然有效提高了磁盘I/O速度，但并无冗余校验功能；\nRAID1：将每一数据块重复存入镜像磁盘，以改善磁盘机的可靠性。镜像盘也称拷贝盘，使有效容量下降了一半，成本较高。\nRAID10：10是先镜像再分块，01是先分块再镜像，显然10的容错性更好。\nRAID2：采用海明码纠错的磁盘阵列，将数据位交叉写入几个磁盘中。按位条带化。\nRAID3：采用奇偶校验冗余的磁盘阵列，也采用数据位交叉，阵列中只有一个校验盘。\n​\t优点：将磁盘分组，采用字节级别的条带，读写要访问所有盘，每组一个盘作为奇偶校验\n​\t缺点：恢复时间长，读写性能水桶效应瓶颈\nRAID4：一种独立传送磁盘阵列，采用数据块交叉，用一个校验盘。将数据按块交叉存储在多个磁盘上。\n​\t优点：冗余代价等于RAID3，访问方法不同于RAID3，使用较少磁盘参与操作，使得磁盘阵列可以并行\t操作\n​\t缺点：随机读快，随机写慢（竞争同一个校验盘）\n测试题 IO设备分类：\n块设备，数据块为单位，速率高可寻址 字符设备：字符为单位，速率低不可寻 MIPS平台的IO端口地址：\n内存映像编址，intel体系是独立IO编址\n设备独立性是实现了： 应用程序与物理设备无关\n设备驱动程序包括： 自动配置和初始化子程序、IO操作子程序、中断服务子程序\n采用双缓冲的条件是： CPU和外设的速度相近\nSPOOLing程序和外设进行数据交换是: 实际IO，虚拟设备技术把独享设备转变成具有共享特征的虚拟设备提高设备利用率\n提高I/O性能的方式： DMA，预先读，延时写，异步IO，缓冲，SPOOLING\nLinux中设备管理的代码占中代码量的： 1/2以上\n某文件占10个磁盘块，现要把该文件的磁盘块逐个读入主存缓冲区，并送用户区进行分析。一个缓冲区与磁盘块大小相等。把一个磁盘块读入缓冲区的时间为100μs，缓冲区数据传送到用户区的时间是50μs，CPU对一块数据进行分析的时间为50μs。分别计算在单缓冲区和双缓冲区结构下，分析完该文件的时间是多少？\n方法：画时序带重叠的图，单缓冲下读入缓冲区和CPU分析可以并行，双缓冲下相邻任务都可以并行。\n单缓冲：150*10+50=1550\n双缓冲：100*10+50+50=1100\n假设磁盘请求以柱面10、35、20、70、2、3 和38的次序到达。寻道时磁头每移动一个柱面需要6ms，磁头起停时间忽略不计，计算以下各算法所需的寻道时间是多少:\na) 假设磁头初始位置为0, 先来先服务\nb) 假设磁头初始位置为0, 最短寻道时间优先\nc) 查看扫描（Look）算法，假设磁头初始位置为15，方向向上(向大柱面号)\n方法：先确定柱面顺序，再加减前后柱面序号得到移动柱面量\n先来先服务，磁头移动的次序为：\n0 → 10 → 35 → 20 → 70 → 2 → 3 → 38\n寻道总时间：(10+25+15+50+68+1+35) * 6 = 1224ms\n最短寻道时间优先，磁头移动的次序为：\n0 → 2 → 3 → 10 → 20 → 35 → 38 → 70\n寻道总时间：(2+1+7+10+15+3+32) * 6 = 420ms\n查看扫描Look算法，磁头移动的次序为：\n15 → 20 → 35 → 38 → 70 → 10 → 3 → 2\n寻道总时间：(5+15+3+32+60+7+1) * 6 = 738ms\n","wordCount":"141","inLanguage":"en","datePublished":"2022-06-12T00:00:00Z","dateModified":"2022-06-12T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://Katock-Cricket.github.io/MyBlog/posts/os5/"},"publisher":{"@type":"Organization","name":"蝈蝈影视公司","logo":{"@type":"ImageObject","url":"https://Katock-Cricket.github.io/MyBlog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><header class=header><nav class=nav><div class=logo><a href=https://Katock-Cricket.github.io/MyBlog accesskey=h title="蝈蝈影视公司 (Alt + H)">蝈蝈影视公司</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://Katock-Cricket.github.io/MyBlog>Home</a>&nbsp;»&nbsp;<a href=https://Katock-Cricket.github.io/MyBlog/posts/>Posts</a></div><h1 class=post-title>OS笔记5：IO系统</h1><div class=post-description>Desc Text.</div><div class=post-meta><span title='2022-06-12 00:00:00 +0000 UTC'>June 12, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/Katock-Cricket/MyBlog/content/posts/os5.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e4%ba%94io%e7%b3%bb%e7%bb%9f aria-label=五、I/O系统>五、I/O系统</a><ul><li><a href=#io%e6%8e%a7%e5%88%b6%e6%96%b9%e5%bc%8f aria-label=IO控制方式>IO控制方式</a><ul><li><a href=#%e7%a8%8b%e5%ba%8f%e6%8e%a7%e5%88%b6io aria-label=程序控制IO>程序控制IO</a></li><li><a href=#%e4%b8%ad%e6%96%ad%e9%a9%b1%e5%8a%a8 aria-label=中断驱动>中断驱动</a></li><li><a href=#dma aria-label=DMA>DMA</a></li><li><a href=#%e9%80%9a%e9%81%93 aria-label=通道>通道</a></li></ul></li><li><a href=#%e7%bc%93%e5%86%b2%e5%8c%ba aria-label=缓冲区>缓冲区</a></li><li><a href=#raid aria-label=RAID>RAID</a></li><li><a href=#%e6%b5%8b%e8%af%95%e9%a2%98 aria-label=测试题>测试题</a><ul><ul><ul><li><a href=#%e8%ae%be%e5%a4%87%e7%8b%ac%e7%ab%8b%e6%80%a7%e6%98%af%e5%ae%9e%e7%8e%b0%e4%ba%86 aria-label=设备独立性是实现了：>设备独立性是实现了：</a></li><li><a href=#%e8%ae%be%e5%a4%87%e9%a9%b1%e5%8a%a8%e7%a8%8b%e5%ba%8f%e5%8c%85%e6%8b%ac aria-label=设备驱动程序包括：>设备驱动程序包括：</a></li><li><a href=#%e9%87%87%e7%94%a8%e5%8f%8c%e7%bc%93%e5%86%b2%e7%9a%84%e6%9d%a1%e4%bb%b6%e6%98%af aria-label=采用双缓冲的条件是：>采用双缓冲的条件是：</a></li><li><a href=#spooling%e7%a8%8b%e5%ba%8f%e5%92%8c%e5%a4%96%e8%ae%be%e8%bf%9b%e8%a1%8c%e6%95%b0%e6%8d%ae%e4%ba%a4%e6%8d%a2%e6%98%af aria-label=SPOOLing程序和外设进行数据交换是:>SPOOLing程序和外设进行数据交换是:</a></li><li><a href=#%e6%8f%90%e9%ab%98io%e6%80%a7%e8%83%bd%e7%9a%84%e6%96%b9%e5%bc%8f aria-label=提高I/O性能的方式：>提高I/O性能的方式：</a></li><li><a href=#linux%e4%b8%ad%e8%ae%be%e5%a4%87%e7%ae%a1%e7%90%86%e7%9a%84%e4%bb%a3%e7%a0%81%e5%8d%a0%e4%b8%ad%e4%bb%a3%e7%a0%81%e9%87%8f%e7%9a%84 aria-label=Linux中设备管理的代码占中代码量的：>Linux中设备管理的代码占中代码量的：</a></li></ul></li></ul></ul></ul></li></ul></div></details></div><div class=post-content><h1 id=五io系统>五、I/O系统<a hidden class=anchor aria-hidden=true href=#五io系统>#</a></h1><h2 id=io控制方式>IO控制方式<a hidden class=anchor aria-hidden=true href=#io控制方式>#</a></h2><h3 id=程序控制io>程序控制IO<a hidden class=anchor aria-hidden=true href=#程序控制io>#</a></h3><p>​ 轮询IO，CPU代表进程向IO模块发出指令，然后忙等，直到IO完成；</p><p>优点：简单</p><p>缺点：CPU效率低</p><h3 id=中断驱动>中断驱动<a hidden class=anchor aria-hidden=true href=#中断驱动>#</a></h3><p>​ 不用不断询问，完成后由设备控制器主动地来通知设备驱动程序说这次结束；</p><p>优点：提高CPU利用率</p><p>缺点：每次IO都要中断CPU，浪费了时间</p><h3 id=dma>DMA<a hidden class=anchor aria-hidden=true href=#dma>#</a></h3><p>​ 直接存储器访问方式，有专门的控制器完成IO</p><p>优点：CPU只需干预开始和结束的工作，而其中的一批数据读写无需CPU控制，适用于数据块传输</p><p>缺点：每个设备一个DMA</p><h3 id=通道>通道<a hidden class=anchor aria-hidden=true href=#通道>#</a></h3><p>​ 一个特殊的有自己的指令的处理器，专门负责IO，与CPU分时使用内存；</p><p>优点：一个通道程序可以完成多个IO操作，减少CPU干预</p><p>缺点：贵</p><h2 id=缓冲区>缓冲区<a hidden class=anchor aria-hidden=true href=#缓冲区>#</a></h2><p>缓冲技术的优点：</p><ol><li>匹配CPU与外设的不同处理速度</li><li>减少CPU中断次数</li><li>提高CPU与IO设备的并行性</li></ol><h2 id=raid>RAID<a hidden class=anchor aria-hidden=true href=#raid>#</a></h2><p>一种把多块独立的硬盘（物理硬盘）按照不同方式组合起来形成一个硬盘组（逻辑硬盘），从而提供比单个硬盘更高的存储性能和提供数据冗余的技术。</p><p>优点：成本低，功耗小，传输速率高，可提供容错功能</p><p><strong>RAID0</strong>：仅提供了并行交叉存取。它虽然有效提高了磁盘I/O速度，但并无冗余校验功能；</p><p><strong>RAID1</strong>：将每一数据块重复存入镜像磁盘，以改善磁盘机的可靠性。镜像盘也称拷贝盘，使有效容量下降了一半，成本较高。</p><p><strong>RAID10</strong>：10是先镜像再分块，01是先分块再镜像，显然10的容错性更好。</p><p><strong>RAID2</strong>：采用海明码纠错的磁盘阵列，将数据位交叉写入几个磁盘中。按位条带化。</p><p><strong>RAID3</strong>：采用奇偶校验冗余的磁盘阵列，也采用数据位交叉，阵列中只有一个校验盘。</p><p>​ 优点：将磁盘分组，采用字节级别的条带，读写要访问所有盘，每组一个盘作为奇偶校验</p><p>​ 缺点：恢复时间长，读写性能水桶效应瓶颈</p><p><strong>RAID4</strong>：一种独立传送磁盘阵列，采用数据块交叉，用一个校验盘。将数据按块交叉存储在多个磁盘上。</p><p>​ 优点：冗余代价等于RAID3，访问方法不同于RAID3，使用较少磁盘参与操作，使得磁盘阵列可以并行 操作</p><p>​ 缺点：随机读快，随机写慢（竞争同一个校验盘）</p><h2 id=测试题>测试题<a hidden class=anchor aria-hidden=true href=#测试题>#</a></h2><p><strong>IO设备分类：</strong></p><ol><li>块设备，数据块为单位，速率高可寻址</li><li>字符设备：字符为单位，速率低不可寻</li></ol><p><strong>MIPS平台的IO端口地址：</strong></p><p>内存映像编址，intel体系是独立IO编址</p><h5 id=设备独立性是实现了>设备独立性是实现了：<a hidden class=anchor aria-hidden=true href=#设备独立性是实现了>#</a></h5><p>应用程序与物理设备无关</p><h5 id=设备驱动程序包括>设备驱动程序包括：<a hidden class=anchor aria-hidden=true href=#设备驱动程序包括>#</a></h5><p>自动配置和初始化子程序、IO操作子程序、中断服务子程序</p><h5 id=采用双缓冲的条件是>采用双缓冲的条件是：<a hidden class=anchor aria-hidden=true href=#采用双缓冲的条件是>#</a></h5><p>CPU和外设的速度相近</p><h5 id=spooling程序和外设进行数据交换是>SPOOLing程序和外设进行数据交换是:<a hidden class=anchor aria-hidden=true href=#spooling程序和外设进行数据交换是>#</a></h5><p>实际IO，虚拟设备技术把独享设备转变成具有共享特征的虚拟设备提高设备利用率</p><h5 id=提高io性能的方式>提高I/O性能的方式：<a hidden class=anchor aria-hidden=true href=#提高io性能的方式>#</a></h5><p>DMA，预先读，延时写，异步IO，缓冲，SPOOLING</p><h5 id=linux中设备管理的代码占中代码量的>Linux中设备管理的代码占中代码量的：<a hidden class=anchor aria-hidden=true href=#linux中设备管理的代码占中代码量的>#</a></h5><p>1/2以上</p><p><strong>某文件占10个磁盘块，现要把该文件的磁盘块逐个读入主存缓冲区，并送用户区进行分析。一个缓冲区与磁盘块大小相等。把一个磁盘块读入缓冲区的时间为100μs，缓冲区数据传送到用户区的时间是50μs，CPU对一块数据进行分析的时间为50μs。分别计算在单缓冲区和双缓冲区结构下，分析完该文件的时间是多少？</strong></p><p>方法：画时序带重叠的图，单缓冲下读入缓冲区和CPU分析可以并行，双缓冲下相邻任务都可以并行。</p><p>单缓冲：150*10+50=1550</p><p>双缓冲：100*10+50+50=1100</p><p><strong>假设磁盘请求以柱面10、35、20、70、2、3 和38的次序到达。寻道时磁头每移动一个柱面需要6ms，磁头起停时间忽略不计，计算以下各算法所需的寻道时间是多少:</strong></p><p><strong>a) 假设磁头初始位置为0, 先来先服务</strong></p><p><strong>b) 假设磁头初始位置为0, 最短寻道时间优先</strong></p><p><strong>c) 查看扫描（Look）算法，假设磁头初始位置为15，方向向上(向大柱面号)</strong></p><p>方法：先确定柱面顺序，再加减前后柱面序号得到移动柱面量</p><p>先来先服务，磁头移动的次序为：</p><p>0 → 10 → 35 → 20 → 70 → 2 → 3 → 38</p><p>寻道总时间：(10+25+15+50+68+1+35) * 6 = 1224ms</p><p>最短寻道时间优先，磁头移动的次序为：</p><p>0 → 2 → 3 → 10 → 20 → 35 → 38 → 70</p><p>寻道总时间：(2+1+7+10+15+3+32) * 6 = 420ms</p><p>查看扫描Look算法，磁头移动的次序为：</p><p>15 → 20 → 35 → 38 → 70 → 10 → 3 → 2</p><p>寻道总时间：(5+15+3+32+60+7+1) * 6 = 738ms</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://Katock-Cricket.github.io/MyBlog/posts/os6/><span class=title>Next Page »</span><br><span>OS笔记6：文件系统</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://Katock-Cricket.github.io/MyBlog>蝈蝈影视公司</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>